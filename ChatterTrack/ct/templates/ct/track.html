{% extends "base.html" %}


{% block title %}ChatterTrack - Tracking Chatter!{% endblock %}
{% block includes %}    
    <!-- CSS -->
    <!-- JS -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}ct/asset/dashboard.js"></script>
    <link rel="stylesheet" href="{{ STATIC_URL }}ct/asset/dashboard.css"> 
{% endblock %}

{% block content %}
    <div class="container">
        <header class="site-header cf" role="banner">
            <div class="site-logo">
                <span style="color: #D9750B;">Chatter<span ><img src="{{ STATIC_URL }}ct/asset/twitter.png" width="45" height="45" /></span><span style="color: #D9750B;">Track<span>
            </div>
        </header>
        
        <h2>Current Streams: </h2>
        <table class="stream-table">
            <thead>
                <th>Picture</th>
                <th>Stream Name</th>
                <th>Tweet Count</th>
                <th>Start Time</th>
                <th>Stop Time</th>
                <th>Stop/Delete</th> 
            </thead>
            <tbody>
                {% for stream in streams %}
                <tr>
                    <td>
                        {% if stream.image  %}
                            <img class="twitter-icon" src="{{ MEDIA_URL }}{{stream.image.name}}" />
                        {% endif %}
                        <form action="/ct/uploadImage/" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            {{ stream.uploadImageForm.stream_id.errors }}
                            {{ stream.uploadImageForm.stream_id }}
                            {{ stream.uploadImageForm.image }}
                            {{ stream.uploadImageForm.image.errors }}
                            <!--<input type="text" name="stream_id" value="{{stream.stream_id}}" style="display:none;">
                            <input type="file" onchange="this.form.submit()" /> -->
                        </form>
                    </td>
                    <td>{{stream.name}}</td>
                    <td>{{stream.count}}</td>
                    <td>{{stream.start_time}}</td>
                    <td>{{stream.end_time}}</td>
                    {% if stream.end_time %}
                        <td><button onclick="dashboard.ajax.deleteStream('{{stream.stream_id}}')">Delete</button></td>
                    {% else %}
                        <td><button onclick="dashboard.ajax.stopStream('{{stream.stream_id}}')">Stop</button></td>
                    {% endif %}                    
                </tr>
                {% empty %}
                </tr>
                    <td colspan=5>You don't have any streams on stored!</td>
                </tr>
                {% endfor %}
            </tbody>
        </table> 
        <hr/>
    {% if form.errors %}
        <p style="color: red;">
            Please correct the error{{ form.errors|pluralize }} below.
        </p>
    {% endif %}
    
        <form action="" method="post">
            {% csrf_token %}
            <div class="field">
                {{ track_form.twitter_handle.errors }}
                <label for="id_twitter_handle">Twitter Handle of the user you want to track:</label>
                {{ track_form.twitter_handle }}
            </div><!--
            <div class="field">
                {{ form.tracking_phrases.errors }}
                <label for="id_tracking_phrases">Comma-separated list of phrases to track:</label>
                {{ form.tracking_phrases }}
            </div>
            <div class="field">
                {{ form.time_to_track.errors }}
                <label for="id_time_to_track">Enter the number of minutes to track them for:</label>
                {{ form.time_to_track }}
            </div>-->
            <input type="submit" value="Submit">
        </form>
    </div>
{% endblock %}



